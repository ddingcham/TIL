# 서킷브레이커를 위한 인프라 배경지식  
#### [그림으로 공부하는 IT 인프라 구조 - 7.무정지를 위한 인프라 구조](https://book.naver.com/bookdb/book_detail.nhn?bid=9252940)  

## 1. 안정성 및 이중화

### 1.1. 안정성이란?  

#### 안정성 =거의비슷= 고가용성 : 시스템 서비스가 가능한 한 멈추지 않도록 하는 것  

#### 안정성 및 고가용성의 목표와 실현 수단
* **실현 수단**
  * **컴포넌트 이중화**의 목표  
    * 고장, 장애에 의한 정지가 발생하지 않을 것  
      > 하드웨어에서는 MTBF  
    * 고장,장애가 발생해도 복구할 수 있을 것  
      > 하드웨어에서는 MTTR  
  * **컴포넌트 감시**의 목표  
    * 고장, 장애가 발생한 것을 검출할 수 있을 것  
  * **데이터 백업**의 목표  
    * 고장, 장애가 발생해도 데이터가 보호될 것  
    
### 1.2. 이중화란?  
#### 하나의 기능을 병렬로 여러 개 나열해서, 하나에 장애가 발생해도 다른 것을 이용해서 서비스를 지속  
#### 병렬 가동의 의미
> 고가용성에 대한 의미뿐만 아니라 확장성이나 부하분산 같은 성능에 대한 의미도 갖는다.  

#### 일반적인 이중화 구조 요구사항  

* 부하분산 : 모두가 균등하게 가마를 들 수 있는 구조  
* 내부적 생존 감시 : 넘어진 사람이 있는지 정기적으로 확인하는 구조  
* 마스터 결정 : (보충 요원이 있는 경우) 스모 선수를 운반하는 사람이 누구인지 판단하는 구조  
* 페일 오버 : (보충 요원이 없는 경우) 안전하게 요원을 교체할 수 있는 구조  

### 5.2. DB 연결 이중화  
#### Connection pooling : 미리 Connection을 여러 개 생성 해놓는 Connection Pooling을 가지고 생각

#### DataSource는 여러 연결을 만들어서 데이터베이스 처리를 병렬로 실행할 수 있게 하는 구조다.  
* 장점  
  * 애플리케이션이 DB 서버의 IP나 포트 등을 몰라도 된다. -> 데이터 소스로 캡슐화  
  * 연결 생성 및 해제 시에 걸리는 시간이나 리소스가 필요 없어서 고속으로 처리가 가능  
 
see also  
> '멀티 데이터 소스', 'Active Gridlink', 'Fast Connection Failover(FCF)', 'Runtime Connection Load Balancing(RCLB)'  

#### 장애 발생 시?  
연결 예약 타임아웃 : 설정 최댓값까지 연결 수가 늘며, 최댓값을 초과한 요구가 오면 일정 시간 대기한다.  
